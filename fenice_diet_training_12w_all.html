<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fenice • Dieta 12w + Allenamento + Galleria esercizi (Foto CC)</title>
<style>
:root{--bg:#0f1320;--panel:#12182a;--ink:#e9eef7;--ink2:#9bb0d0;--line:#2c3550;--tab:#1a2033}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,sans-serif}
header{position:sticky;top:0;z-index:50;background:#0b0e19;border-bottom:1px solid var(--line);padding:10px 14px;display:flex;gap:10px;align-items:center}
h1{font-size:18px;margin:0} nav{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
nav a{color:var(--ink);text-decoration:none;border:1px solid var(--line);padding:8px 10px;border-radius:10px}
nav a.active{background:#1a2033}
.container{max-width:1100px;margin:0 auto;padding:16px}
.panel{background:#12182a;border:1px solid #2c3550;border-radius:16px;padding:16px;margin-bottom:16px}
.muted{color:#9bb0d0}.mono{font-family:ui-monospace,Menlo,Consolas,monospace;font-size:12px}
table{width:100%;border-collapse:collapse} th,td{border-bottom:1px solid #222a3d;padding:8px 6px;vertical-align:top} th{text-align:left;color:#9bb0d0}
.badge{font-size:12px;border:1px solid var(--line);border-radius:999px;padding:2px 8px;opacity:.9}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px} @media(max-width:900px){.grid2{grid-template-columns:1fr}}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}@media(max-width:920px){.grid{grid-template-columns:1fr}}
.card{background:#0b0e19;border:1px solid #2c3550;border-radius:14px;padding:14px}
h3{margin:0 0 8px 0} p{margin:6px 0}.small{color:#9bb0d0;font-size:12px}
a.btn{display:inline-block;margin-top:6px;border:1px solid var(--line);border-radius:10px;padding:6px 10px;text-decoration:none;color:var(--ink)}
.thumb{width:100%;display:block;border-radius:10px;border:1px solid #2c3550}
.cap{font-size:11px;color:#cbd5e1;margin-top:4px}
.skel{background:#0f1528;height:140px;border-radius:10px;border:1px solid #2c3550}
</style>
</head>
<body>
<header>
  <h1>Fenice — Dieta 12 settimane + Allenamento</h1>
  <nav>
    <a href="#diet" class="tab active" data-target="diet">Dieta</a>
    <a href="#train" class="tab" data-target="train">Allenamento</a>
    <a href="#gallery" class="tab" data-target="gallery">Esercizi (Foto CC)</a>
    <a href="#legend" class="tab" data-target="legend">Legenda</a>
    <a href="#calendar" class="tab" data-target="calendar">Calendari</a>
  </nav>
</header>

<div class="container view" id="diet">
  <div class="panel">
    <h2>Piano alimentare 12 settimane <span class="badge">4 pasti/giorno</span></h2>
    <p class="muted">Inizio: <span id="start-date">2025-08-11</span>. Orari adattati a ferie/doppi turni/schema standard.</p>
  </div>
  <div id="weeks"></div>
</div>

<div class="container view" id="train" style="display:none">
  <div class="panel">
    <h2>Allenamento — Upper/Lower (4×/sett)</h2>
    <div class="grid2">
      <div class="panel">
        <h3>Video rapidi (forma corretta)</h3>
        <ul>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=bench+press+form+powerlifting+cues">Bench Press — tecnica</a></li>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=back+squat+bracing+depth+high+bar+low+bar">Back Squat — bracing/profondità</a></li>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=pull+up+scapular+depression+form">Pull-up — controllo scapolare</a></li>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=overhead+press+bar+path+form">Shoulder Press — linea overhead</a></li>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=plank+neutral+spine+form">Plank — allineamento</a></li>
          <li><a class="btn" target="_blank" href="https://www.youtube.com/results?search_query=biceps+curl+strict+form+no+swing">Biceps Curl — gomiti fermi</a></li>
        </ul>
      </div>
      <div class="panel">
        <h3>Progressione</h3>
        <p class="small">RPE 7→9 sulle serie target; +2.5–5 kg sett. se tutte le serie sono in target. Core in bracing, ROM controllato.</p>
      </div>
    </div>
  </div>
</div>

<div class="container view" id="gallery" style="display:none">
  <div class="panel">
    <h2>Galleria esercizi — foto reali (da Wikimedia Commons, CC)</h2>
    <div class="grid" id="exgrid"></div>
    <p class="small">Clicca “Foto (Wikimedia, CC)” per la pagina completa e verifica la licenza specifica.</p>
  </div>
</div>

<div class="container view" id="legend" style="display:none">
  <div class="panel">
    <h2>Legenda</h2>
    <ul>
      <li><b>RPE</b>: sforzo percepito (0–10). RPE 8 ≈ 2 ripetizioni “in canna”.</li>
      <li><b>1RM</b>: massimale su 1 ripetizione.</li>
      <li><b>BF</b>: body fat (percentuale di grasso).</li>
      <li><b>ROM</b>: range di movimento.</li>
      <li><b>MRGE</b>: reflusso gastroesofageo — evitare alimenti acidi, preferire cotture semplici.</li>
      <li><b>Macro</b>: Proteine 4 kcal/g, Carbo 4 kcal/g, Grassi 9 kcal/g.</li>
    </ul>
  </div>
</div>

<div class="container view" id="calendar" style="display:none">
  <div class="panel">
    <h2>Calendari (.ics)</h2>
    <ul>
      <li><a class="btn" href="./Fenice_Work.ics" download>Fenice_Work.ics</a></li>
      <li><a class="btn" href="./Fenice_Training.ics" download>Fenice_Training.ics</a></li>
      <li><a class="btn" href="./Fenice_Study.ics" download>Fenice_Study.ics</a></li>
      <li><a class="btn" href="./Fenice_Classes.ics" download>Fenice_Classes.ics</a></li>
      <li><a class="btn" href="./Fenice_Internship.ics" download>Fenice_Internship.ics</a></li>
    </ul>
    <p class="small">Suggerito: sottoscrizione via URL (GitHub Pages) per aggiornamenti automatici.</p>
  </div>
</div>

<script>
// Router
const tabs=[...document.querySelectorAll('.tab')], views=[...document.querySelectorAll('.view')];
function show(id){views.forEach(v=>v.style.display=(v.id===id)?'':'none');tabs.forEach(t=>t.classList.toggle('active',t.dataset.target===id));}
function route(h){const id=(h||'#diet').replace('#','');show(id);} 
tabs.forEach(t=>t.addEventListener('click',e=>{e.preventDefault();const id=t.dataset.target;history.pushState(null,'','#'+id);route('#'+id)})); 
addEventListener('hashchange',()=>route(location.hash)); 
document.addEventListener('DOMContentLoaded',()=>route(location.hash||'#diet'));

// Diet generator (12 weeks)
const START=new Date('2025-08-11'), WEEKS=12;
function italianDay(d){return ['Lunedì','Martedì','Mercoledì','Giovedì','Venerdì','Sabato','Domenica'][d.getDay()===0?6:d.getDay()-1]}
function fmt(d){return d.toISOString().slice(0,10);} 
function between(d,y,m,a,b){const x=new Date(d);return x>=new Date(y,m-1,a)&&x<=new Date(y,m-1,b)}
function mealsOfDay(d){
  const wd=d.getDay();
  if(between(d,2025,8,11,20)) return [['07:00','Colazione','Avena 80g + latte scremato 200ml + banana'],['11:00','Spuntino','Yogurt greco 0% 170g + 15 mandorle'],['19:30','Cena','Riso basmati 100g + tacchino 180g + verdure crude + 15g EVO'],['22:30','Spuntino','Whey 30g + gallette 30g']];
  if(between(d,2025,8,21,31)){const dinner=(fmt(d)==='2025-08-25'?'19:30':'16:30');return [['06:30','Colazione','Pane integrale 80g + albumi 200g + 1 frutto'],['10:00','Spuntino','Fiocchi di latte 200g + 1 mela'],[dinner,'Cena','Patate 450g + pollo 180g + insalata + 15g EVO'],['22:30','Spuntino','Whey 30g + 15g noci']];}
  if(d.getDay()===1) return [['07:00','Colazione','Avena 80g + acqua + 1 banana'],['11:30','Spuntino','Yogurt greco 0% 170g + 20g miele'],['19:30','Cena','Farro 110g + tonno 120g + verdure crude + 15g EVO'],['22:30','Spuntino','Whey 30g + 10g burro d\'arachidi']];
  if([2,3,4,5].includes(d.getDay())) return [['06:45','Colazione','Pane segale 90g + ricotta magra 150g + marmellata 20g'],['11:00','Spuntino','Fiocchi di latte 200g + 15 mandorle'],['17:00','Cena','Riso integrale 100g + pollo 180g + verdure crude + 15g EVO'],['22:30','Spuntino','Whey 30g + gallette 30g']];
  return [['06:30','Colazione','Avena 80g + latte vegetale 200ml + 1 frutto'],['10:00','Spuntino','Yogurt 0% 170g + 15 mandorle'],['16:30','Cena','Orzo 110g + manzo magro 180g + insalata + 15g EVO'],['22:30','Spuntino','Whey 30g + 10g burro d\'arachidi']];
}
function macros(kcal, phase){
  const P=(phase==='Recomp')?0.28:(phase==='Cut')?0.33:0.25, C=(phase==='Recomp')?0.46:(phase==='Cut')?0.38:0.52, F=(phase==='Recomp')?0.26:(phase==='Cut')?0.29:0.23;
  const p=Math.round(kcal*P/4), c=Math.round(kcal*C/4), f=Math.round(kcal*F/9); return `P${p} C${c} F${f}`;
}
function kcalsForDay(d){
  const dayIndex=Math.floor((d-START)/(1000*3600*24)), w=Math.floor(dayIndex/7)+1;
  let base=(w<=4)?2600:(w<=8)?2300:3000;
  if([2,4,6,0].includes(d.getDay())) base+=100; if(d.getDay()===1) base-=100; return base;
}
function phaseOfWeek(w){return (w<=4)?'Recomp':(w<=8)?'Cut':'Bulk';}
function renderWeeks(){
  const weeks=document.getElementById('weeks'); weeks.innerHTML='';
  document.getElementById('start-date').textContent=START.toISOString().slice(0,10);
  for(let w=1; w<=WEEKS; w++){
    const phase=phaseOfWeek(w), base=(phase==='Recomp')?2600:(phase==='Cut')?2300:3000;
    const card=document.createElement('div'); card.className='panel'; card.innerHTML=`<h3>Settimana ${w} <span class="badge">${phase} • ~${base} kcal/d</span></h3>`;
    const t=document.createElement('table'); t.innerHTML='<thead><tr><th>Giorno</th><th>Pasto</th><th>Orario</th><th>Contenuto</th><th>Macro stimati</th></tr></thead>';
    const tb=document.createElement('tbody');
    for(let d=0; d<7; d++){
      const dd=new Date(START.getTime()+((w-1)*7+d)*86400000); const M=mealsOfDay(dd); const kcal=kcalsForDay(dd); const splits=[0.30,0.15,0.40,0.15];
      for(let m=0;m<M.length;m++){
        const tr=document.createElement('tr'); const [hh, name, desc]=M[m]; const mk=Math.round(kcal*splits[m]); const mm=macros(mk, phase);
        tr.innerHTML=(m===0?`<td rowspan="4"><b>${italianDay(dd)}</b><br><small class="muted">${dd.toISOString().slice(0,10)}</small></td>`:'')
          + `<td>${name}</td><td>${hh}</td><td>${desc}</td><td class="mono">${mk} kcal · ${mm}</td>`;
        tb.appendChild(tr);
      }
    }
    t.appendChild(tb); card.appendChild(t); weeks.appendChild(card);
  }
}
renderWeeks();

// Exercises with CC thumbnails via Wikimedia Commons API
const EX = [
  ["Bench Press (Panca piana)","Petto, tricipiti, deltoidi ant","Piedi stabili, scapole addotte/depresse, trai una linea verticale sul petto.","bench press gym"],
  ["Pull-up / Lat Pulldown (Trazioni / Lat machine)","Dorsali, bicipiti","Depressione scapole prima di tirare, mento oltre sbarra, no slanci.","pull up exercise"],
  ["Barbell Row / Seated Row (Rematore)","Dorsali, romboidi","Core in bracing, gomiti verso il fianco, ferma al busto.","barbell row"],
  ["Lateral Raises (Alzate laterali)","Deltoidi laterali","Polsi neutri, leggera intrarotazione, trai con il gomito.","lateral raise dumbbell"],
  ["Biceps Curl (Curl bicipiti)","Bicipiti","Gomiti fermi, spalle basse, pieno ROM controllato.","biceps curl"],
  ["Triceps Pushdown (Pushdown)","Tricipiti","Gomiti bloccati al fianco, completa estensione controllata.","triceps pushdown cable"],
  ["Back Squat (Squat)","Quadricipiti, glutei, core","Bracing 360°, ginocchia seguono la punta del piede, profondità coerente.","barbell back squat"],
  ["Romanian Deadlift (Stacco rumeno)","Femorali, glutei","Anca indietro, tibie verticali, barra vicina al corpo.","romanian deadlift"],
  ["Lunges (Affondi)","Quadricipiti, glutei","Passo lungo, ginocchio dietro verso il suolo, busto alto.","lunge exercise"],
  ["Calf Raises (Polpacci)","Gastrocnemio, soleo","Pieno allungamento e contrazione in alto, no rimbalzo.","calf raise machine"],
  ["Core — Plank","Addome profondo","Colonna neutra, glutei contratti, scapole attive.","plank exercise"],
  ["Incline Bench Press (Panca inclinata)","Petto alto, deltoidi ant, tricipiti","Scapole addotte, trai al petto alto, polsi neutri.","incline bench press"],
  ["Machine Row (Rematore macchina)","Dorsali, romboidi","Spalle giù, petto alto, ferma alle costole.","seated row machine"],
  ["Overhead Press (Lento avanti)","Deltoidi, tricipiti","Glutei stretti, core in bracing, trai vicino alla linea del volto.","overhead press"],
  ["Pullover (Manubrio/Macchina)","Gran dorsale, petto","Coste giù, trai con il dorso, arco controllato.","dumbbell pullover"],
  ["Biceps Curl (variante)","Bicipiti","Varia 12–15 rip, tempo controllato.","biceps curl dumbbell"],
  ["French Press / Skullcrusher","Tricipiti","Gomiti stretti, arco controllato, evita stress ai polsi.","skullcrusher lying triceps extension"],
  ["Deadlift / Varianti (Stacco)","Catena posteriore","Piedi sotto la barra, dorsale attivo, spingi il pavimento.","deadlift"],
  ["Leg Press","Quadricipiti, glutei","Schiena appoggiata, ROM profondo senza stacco lombare.","leg press"],
  ["Leg Curl","Femorali","Controllo eccentrico, no slanci.","leg curl machine"],
  ["Calf Raises (var.)","Polpacci","Punta/extra ROM se possibile, fermo in alto.","standing calf raise"],
  ["Core — Hollow Hold","Addome profondo","Coste giù, zona lombare in appoggio, braccia/gambe tese.","hollow body hold"]
];

const grid = document.getElementById('exgrid');

function renderExerciseCard(ex, thumb, title, filepage){
  const [name,muscles,cues,query] = ex;
  const wikSearch = `https://commons.wikimedia.org/w/index.php?search=${encodeURIComponent(query)}+&title=Special%3ASearch&ns6=1&ns14=1&filemime=image%2Fjpeg%2Cimage%2Fpng&advanced=1&license=cc&move=1`;
  const yt = `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}+form+technique`;
  const img = thumb ? `<img class="thumb" src="${thumb}" alt="${title||name}">` : `<div class="skel"></div>`;
  const cap = filepage ? `<div class="cap"><a href="${filepage}" target="_blank" rel="noopener">Fonte: Wikimedia Commons</a></div>` : '';
  const el = document.createElement('section'); el.className='card';
  el.innerHTML = `<h3>${name}</h3>
    ${img}${cap}
    <p class="small"><b>Muscoli:</b> ${muscles}</p>
    <p class="small"><b>Cues:</b> ${cues}</p>
    <p><a class="btn" target="_blank" href="${wikSearch}">📷 Foto (Wikimedia, CC)</a>
       <a class="btn" target="_blank" href="${yt}">▶️ Video (YouTube)</a></p>`;
  grid.appendChild(el);
}

async function fetchThumbForQuery(query){
  const endpoint = 'https://commons.wikimedia.org/w/api.php';
  const params = new URLSearchParams({
    action: 'query',
    format: 'json',
    origin: '*',
    prop: 'imageinfo',
    generator: 'search',
    gsrlimit: '1',
    gsrsearch: query,
    iiprop: 'url|extmetadata',
    iiurlwidth: '600'
  });
  const url = `${endpoint}?${params.toString()}`;
  try{
    const res = await fetch(url);
    const data = await res.json();
    if(!data.query || !data.query.pages) return {thumb:null,title:null,filepage:null};
    const page = Object.values(data.query.pages)[0];
    if(!page || !page.imageinfo || !page.imageinfo[0]) return {thumb:null,title:page?.title||null,filepage: page? `https://commons.wikimedia.org/wiki/${encodeURIComponent(page.title)}`: null};
    const ii = page.imageinfo[0];
    const thumb = ii.thumburl || ii.url;
    const title = page.title || '';
    const filepage = ii.descriptionshorturl || `https://commons.wikimedia.org/wiki/${encodeURIComponent(page.title)}`;
    return {thumb,title,filepage};
  }catch(e){
    return {thumb:null,title:null,filepage:null};
  }
}

(async function(){
  // skeletons first (lightweight paint)
  for(const ex of EX){ renderExerciseCard(ex, null, null, null); }
  // then replace with fetched thumbs
  grid.innerHTML='';
  for(const ex of EX){
    const {thumb,title,filepage} = await fetchThumbForQuery(ex[3]);
    renderExerciseCard(ex, thumb, title, filepage);
  }
})();
</script>
</body>
</html>
